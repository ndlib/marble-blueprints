---
AWSTemplateFormatVersion: '2010-09-09'

Description: >
  This CloudFormation will create the following:

    - Exports for the current VPCID and SubnetIDs that exist in your existing account,
    with consistency for the rest of the Marble project

Parameters:
  VPC:
    Type: AWS::EC2::VPC::Id
    Description: The VPC ID where the required networking exists
    Default: ''

  EnvironmentName:
    Type: String
    Description: Any value that describes where the service exists
    Default: "dev"

  PrivateSubnet1:
    Type: AWS::EC2::Subnet::Id
    Description: One of the private subnets in your existing account
    Default: ''

  PrivateSubnet2:
    Type: AWS::EC2::Subnet::Id
    Description: A second of the private subnets in your existing account
    Default: ''

  PublicSubnet1:
    Type: AWS::EC2::Subnet::Id
    Description: One of the public subnets in your existing account
    Default: ''

  PublicSubnet2:
    Type: AWS::EC2::Subnet::Id
    Description: A second of the public subnets in your existing account
    Default: ''

Resources:
  VPCIDParameter:
    Type: AWS::SSM::Parameter
    Properties:
      Type: String
      Name: !Sub '/all/stacks/${AWS::StackName}/vpcid'
      Description: The VPCID to use for existing resources
      Value: !Ref VPC

Outputs:

  PublicSubnet1ID:
    Description: The subnet ID of the 1st public subnet
    Value: !Ref PublicSubnet1
    Export:
      Name: !Join [ ':', [ !Ref 'AWS::StackName', 'PublicSubnet1ID']]

  PublicSubnet2ID:
    Description: The subnet ID of the 2nd public subnet
    Value: !Ref PublicSubnet2
    Export:
      Name: !Join [ ':', [ !Ref 'AWS::StackName', 'PublicSubnet2ID']]

  PrivateSubnet1ID:
    Description: The subnet ID of the 1st private subnet
    Value: !Ref PrivateSubnet1
    Export:
      Name: !Join [ ':', [ !Ref 'AWS::StackName', 'PrivateSubnet1ID']]

  PrivateSubnet2ID:
    Description: The subnet ID of the 2nd private subnet
    Value: !Ref PrivateSubnet2
    Export:
      Name: !Join [ ':', [ !Ref 'AWS::StackName', 'PrivateSubnet2ID']]

  VPCID:
    Description: The ID of the created VPC
    Value: !Ref VPC
    Export:
      Name: !Join [ ':', [ !Ref 'AWS::StackName', 'VPCID']]
